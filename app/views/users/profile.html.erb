
<h1><%= @current_user.username %> </h1>

<dl>
  <dt>Private</dt>
  <dd><%= @current_user.private %></dd>
  <dt>Followers</dt>
  <dd>
    <%= @followers_count %>

  <% if @current_user.username == params.fetch("username") %> 
    <h4>Pending follow requests</h4>

      <ul>
        <% @pending_followers.each do |a_request| %>
          <%= User.where({ :id => a_request.sender_id}).at(0).username %>    
        <% end %>
      </ul>
  <% end %>
  <% if @current_user.username != params.fetch("username") %>
    <% if FollowRequest.where({ :sender_id => @current_user.id, :recipient_id => User.where({ :username => params.fetch("username")}).at(0).id }).at(0) == nil %>
      <form action="/follow" method="post">
                  <input type="hidden" name="query_recipient_id" value="70">
                  <button>
                    Follow
                  </button>
                </form>
    <% else %>
      <div>
          <a href="/delete_follow_request/1854">
            Unfollow
          </a>
       </div>
    <% end %>
  <% end %>
  </dd>
  <dt>Following</dt>
  <dd><%= @following_count %></dd>

<% if @current_user.username == params.fetch("username") %>
  <dt>Edit user</dt>
  <dd>
    <form action="/modify_user/81" method="post">
      <label for="browser_username">Username</label>
      <input id="browser_username" type="text" name="query_username" placeholder="Enter a username..."
        value="<%= @current_user.username %>">

      <label for="browser_private">Private?</label>
      <input id="browser_private" type="checkbox" name="query_private" >

      <button>Update user</button>
    </form>
<% end %>
</dl>

<h1>Own photos (<%= @user_photos.count %>) </h1>
<hr>
  <div>
    <div>
      <table border="1">
        <tr>
          <th>Image</th>
          <th>Owner</th>
          <th>Caption</th>
          <th>Posted</th>
          <th>Likes</th>
          <th></th>
        </tr>

        <% @user_photos.each do |a_photo| %>
            <tr>
                <td>
                  <img src="<%= a_photo.image %>">
                </td>

                <td>
                  <%= a_photo.owner_id %>
                </td>
              
                <td>
                <%= a_photo.caption %>
                </td>
              
                <td>
                  <%= distance_of_time_in_words(Time.now, a_photo.created_at) %> ago
                </td>
              
                <td>
                  <%= a_photo.likes_count %>
                </td>
              
                <td>
                  <a href="/photos/<%= a_photo.id %>">
                    Show details
                  </a>
                </td>
              </tr>
            
          <% end %>
      </table>
    </div>
  </div>
</hr> 
